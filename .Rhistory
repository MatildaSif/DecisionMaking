mutate(gain = as.numeric(gain),
loss = as.numeric(loss),
payoff = gain + loss) %>%
group_by(subjID, group) %>%
arrange(trial) %>%
mutate(cumulative_payoff = cumsum(payoff))
# plot again as a line with density plotting total accumulative payoff over trials
all_data %>%
ggplot(aes(x = trial, y = cumulative_payoff, group = subjID, color = group)) +
geom_line(alpha = 0.2) +  # faint individual lines
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Cumulative Payoff Over Trials by Group",
x = "Trial",
y = "Cumulative Payoff") +
theme_minimal()
# plot again as a line with density plotting total accumulative payoff over trials
all_data %>%
ggplot(aes(x = trial, y = cumulative_payoff, group = subjID, color = group)) +
geom_line(alpha = 0.1) +  # faint individual lines
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Cumulative Payoff Over Trials by Group",
x = "Trial",
y = "Cumulative Payoff") +
theme_minimal()
all_data %>%
ggplot(aes(x = trial, y = cumulative_payoff, color = group)) +
geom_line(aes(group = subjID), alpha = 0.2) +  # faint individual lines
geom_smooth(aes(group = group), method = "loess", se = TRUE, size = 1.5) +
labs(title = "Cumulative Payoff Over Trials by Group (with SE)",
x = "Trial",
y = "Cumulative Payoff") +
theme_minimal()
# smoothed lines
all_data %>%
ggplot(aes(x = trial, y = cumulative_payoff, color = group))
geom_smooth(aes(group = group), method = "loess", se = TRUE, size = 1.5) +
labs(title = "Cumulative Payoff Over Trials by Group (with SE)",
x = "Trial",
y = "Cumulative Payoff") +
theme_minimal()
# smoothed lines
all_data %>%
ggplot(aes(x = trial, y = cumulative_payoff, color = group)) +
geom_smooth(aes(group = group), method = "loess", se = TRUE, size = 1.5) +
labs(title = "Cumulative Payoff Over Trials by Group (with SE)",
x = "Trial",
y = "Cumulative Payoff") +
theme_minimal()
# plot again as a line with density plotting total accumulative payoff over trials
all_data %>%
ggplot(aes(x = trial, y = cumulative_payoff, group = subjID, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Cumulative Payoff Over Trials by Group",
x = "Trial",
y = "Cumulative Payoff") +
theme_minimal()
# plot payoff per deck overall
all_data %>%
group_by(deck) %>%
ggplot(aes(x = deck, y = cumulative_payoff, fill = deck)) +
geom_bar(stat = "identity", alpha = 0.7) +
labs(title = "Total Payoff by Deck",
x = "Deck",
y = "Total Payoff (Gains + Losses)") +
theme_minimal()
# split decks into adv and disadv decks
#two of the decks (decks C and D) are advantageous (“good”) and two (decks A and B) are disadvantageous (“bad”) in terms of their long-term payoffs.
all_data <- all_data %>%
mutate(deck_type = case_when(
deck %in% c("3", "4") ~ "advantageous",
deck %in% c("1", "2") ~ "disadvantageous",
TRUE ~ NA_character_
))
# split decks into adv and disadv decks
#two of the decks (decks C and D) are advantageous (“good”) and two (decks A and B) are disadvantageous (“bad”) in terms of their long-term payoffs.
all_data <- all_data %>%
mutate(deck_type = case_when(
deck %in% c("3", "4") ~ "advantageous",
deck %in% c("1", "2") ~ "disadvantageous",
TRUE ~ NA_character_
))
# Plot net score of “advantageous”—“disadvantageous” choices
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = group, y = net_score, fill = group)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices by Group",
x = "Group",
y = "Net Score (Advantageous - Disadvantageous)")+
theme_minimal()
# Plot net score of “advantageous”—“disadvantageous” choices
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = group, y = net_score, fill = group)) +
geom_line() +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices by Group",
x = "Group",
y = "Net Score (Advantageous - Disadvantageous)")+
theme_minimal()
# Line Plot net score of “advantageous”—“disadvantageous” choices
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = group, y = net_score, fill = group)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices by Group",
x = "Group",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# now with geom_line
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = group, y = net_score, group = subjID, color = group)) +
geom_line(alpha = 0.3) +
geom_point() +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices by Group",
x = "Group",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# now with geom_line showing over blocks where 100 trials are split into 5 blocks
all_data %>%
mutate(block = ceiling(trial / 20)) %>%
group_by(subjID, group, block, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = block, y = net_score, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices Over Blocks by Group",
x = "Block (20 Trials Each)",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# split the 100 trials were divided into five blocks of 20 trials. Shaded regions indicate ±1 s.e.m.
all_data <- all_data %>%
mutate(block = ceiling(trial / 20))
# split the 100 trials were divided into five blocks of 20 trials. Shaded regions indicate ±1 s.e.m. Hard code
all_data <- all_data %>%
mutate(block = ceiling(as.numeric(trial / 20)))
df <- df %>%
group_by(participant) %>%               # Group by participant
mutate(block = ceiling(trial / 20)) %>% # Assign block based on trial number
ungroup()
# split the 100 trials were divided into five blocks of 20 trials
df <- df %>%
mutate(block = case_when(
trial >= 1  & trial <= 19 ~ 1,
trial >= 20 & trial <= 39 ~ 2,
trial >= 40 & trial <= 59 ~ 3,
trial >= 60 & trial <= 79 ~ 4,
trial >= 80 & trial <= 100 ~ 5,
TRUE ~ NA_real_  # in case a trial number falls outside 1-100
))
# split the 100 trials were divided into five blocks of 20 trials
all_data <- all_data %>%
mutate(block = case_when(
trial >= 1  & trial <= 19 ~ 1,
trial >= 20 & trial <= 39 ~ 2,
trial >= 40 & trial <= 59 ~ 3,
trial >= 60 & trial <= 79 ~ 4,
trial >= 80 & trial <= 100 ~ 5,
TRUE ~ NA_real_  # in case a trial number falls outside 1-100
))
# Line Plot net score of “advantageous”—“disadvantageous” choices
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = group, y = net_score, fill = group)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices by Group",
x = "Group",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# now with geom_line showing over blocks where 100 trials are split into 5 blocks
all_data %>%
mutate(block = ceiling(trial / 20)) %>%
group_by(subjID, group, block, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = block, y = net_score, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices Over Blocks by Group",
x = "Block (20 Trials Each)",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# now with geom_line showing over blocks where 100 trials are split into 5 blocks
all_data %>%
group_by(subjID, group, block, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = block, y = net_score, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices Over Blocks by Group",
x = "Block (20 Trials Each)",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# split the 100 trials were divided into five blocks of 20 trials
all_data <- all_data %>%
mutate(block = case_when(
trial >= 1  & trial <= 19 ~ 1,
trial >= 20 & trial <= 39 ~ 2,
trial >= 40 & trial <= 59 ~ 3,
trial >= 60 & trial <= 79 ~ 4,
trial >= 80 & trial <= 100 ~ 5
))
# now with geom_line showing over blocks where 100 trials are split into 5 blocks
all_data %>%
group_by(subjID, group, block, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = block, y = net_score, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices Over Blocks by Group",
x = "Block (20 Trials Each)",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# Check which rows have NA or non-numeric values in the plotting variable
problem_rows <- all_data[!is.finite(df$some_value), ]
problem_rows
# Check which rows have NA or non-numeric values in the plotting variable
problem_rows <- all_data[!is.finite(df$some_value), ]
# split the 100 trials were divided into five blocks of 20 trials
all_data <- all_data %>%
mutate(block = case_when(
trial >= 1  & trial <= 19 ~ 1,
trial >= 20 & trial <= 39 ~ 2,
trial >= 40 & trial <= 59 ~ 3,
trial >= 60 & trial <= 79 ~ 4,
trial >= 80 & trial <= 100 ~ 5,
TRUE ~ NA_real_
))
# Check which rows have NA or non-numeric values in the plotting variable
problem_rows <- all_data[!is.finite(df$some_value), ]
# Check which rows have NA or non-numeric values in the plotting variable
df[is.na(df$block), ]
summary(df$block)
# Check which rows have NA or non-numeric values in the plotting variable
all_data[is.na(df$block), ]
summary(all_data$block)
summary(all_data$some_value)
# Check which rows have NA or non-numeric values in the plotting variable
all_data[is.na(df$block), ]
# Check which rows have NA or non-numeric values in the plotting variable
summary(all_data$block)
unique(all_data$trial[is.na(all_data$block)])
# split the 100 trials were divided into five blocks of 20 trials
all_data <- all_data %>%
mutate(block = case_when(
trial >= 1  & trial <= 19 ~ 1,
trial >= 20 & trial <= 39 ~ 2,
trial >= 40 & trial <= 59 ~ 3,
trial >= 60 & trial <= 79 ~ 4,
trial >= 80 & trial <= 100 ~ 5
))
# Check which rows have NA or non-numeric values in the plotting variable
summary(all_data$block)
unique(all_data$trial[is.na(all_data$block)])
# split the 100 trials were divided into five blocks of 20 trials
all_data <- all_data %>%
mutate(trial = as.numeric(trial)) %>%
mutate(block = case_when(
trial >= 1  & trial <= 19 ~ 1,
trial >= 20 & trial <= 39 ~ 2,
trial >= 40 & trial <= 59 ~ 3,
trial >= 60 & trial <= 79 ~ 4,
trial >= 80 & trial <= 100 ~ 5
))
# now with geom_line showing over blocks where 100 trials are split into 5 blocks
all_data %>%
group_by(subjID, group, block, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = block, y = net_score, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Net Score of Advantageous vs Disadvantageous Choices Over Blocks by Group",
x = "Block (20 Trials Each)",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# Check which rows have NA or non-numeric values in the plotting variable
summary(all_data$block)
unique(all_data$trial[is.na(all_data$block)])
# Calculate % choices from "good" decks (C, D) vs. "bad" decks (A, B)
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(total = advantageous + disadvantageous,
percent_advantageous = (advantageous / total) * 100,
percent_disadvantageous = (disadvantageous / total) * 100) %>%
group_by(group) %>%
summarise(mean_percent_advantageous = mean(percent_advantageous),
mean_percent_disadvantageous = mean(percent_disadvantageous))
# Calculate % choices from "good" decks (C, D) vs. "bad" decks (A, B)
all_data %>%
group_by(group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(total = advantageous + disadvantageous,
percent_advantageous = (advantageous / total) * 100,
percent_disadvantageous = (disadvantageous / total) * 100) %>%
group_by(group) %>%
summarise(mean_percent_advantageous = mean(percent_advantageous),
mean_percent_disadvantageous = mean(percent_disadvantageous))
subjID,
# Calculate % choices from "good" decks (C, D) vs. "bad" decks (A, B)
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(total = advantageous + disadvantageous,
percent_advantageous = (advantageous / total) * 100,
percent_disadvantageous = (disadvantageous / total) * 100) %>%
group_by(group) %>%
summarise(mean_percent_advantageous = mean(percent_advantageous),
mean_percent_disadvantageous = mean(percent_disadvantageous))
# Calculate % choices from "good" decks (C, D) vs. "bad" decks (A, B)
all_data %>%
group_by(subjID; group, deck_type) %>%
# Calculate % choices from "good" decks (C, D) vs. "bad" decks (A, B)
all_data %>%
group_by(subjID, group, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(total = advantageous + disadvantageous,
percent_advantageous = (advantageous / total) * 100,
percent_disadvantageous = (disadvantageous / total) * 100) %>%
group_by(group) %>%
summarise(mean_percent_advantageous = mean(percent_advantageous),
mean_percent_disadvantageous = mean(percent_disadvantageous))
# plot Learning curves across trial blocks
all_data %>%
group_by(subjID, group, block, deck_type) %>%
summarise(total_choices = n()) %>%
pivot_wider(names_from = deck_type, values_from = total_choices, values_fill = 0) %>%
mutate(net_score = advantageous - disadvantageous) %>%
ggplot(aes(x = block, y = net_score, color = group)) +
stat_summary(aes(group = group, color = group), fun = mean, geom = "line", size = 1.5) +
labs(title = "Learning Curves: Net Score Over Blocks by Group",
x = "Block (20 Trials Each)",
y = "Net Score (Advantageous - Disadvantageous)") +
theme_minimal()
# plot how often each deck is chosen per group
all_data %>%
group_by(subjID, group, deck) %>%
summarise(total_choices = n()) %>%
ggplot(aes(x = deck, y = total_choices, fill = group)) +
geom_bar(stat = "identity", position = "dodge", alpha = 0.7) +
labs(title = "Total Choices per Deck by Group",
x = "Deck",
y = "Total Choices") +
theme_minimal()
# plot how often each deck is chosen per group
deck_counts <- all_data %>%
group_by(group, deck) %>%          # group by group and deck
summarise(n_choices = n(), .groups = "drop")
ggplot(deck_counts, aes(x = deck, y = n_choices, fill = group)) +
geom_col(position = "dodge") +      # side-by-side bars for each group
labs(
title = "Number of Choices per Deck by Group",
x = "Deck",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
ggplot(deck_counts, aes(x = deck, y = n_choices, fill = group)) +
geom_col(position = "dodge") +      # side-by-side bars for each group
labs(
title = "Number of Choices per Deck by Group",
x = "Deck",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Plot how advantageous and disadvantageous decks are chosen per group
adv_disadv_counts <- all_data %>%
group_by(group, deck_type) %>%
summarise(n_choices = n(), .groups = "drop")
ggplot(adv_disadv_counts, aes(x = deck_type, y = n_choices, fill = group))
ggplot(adv_disadv_counts, aes(x = deck_type, y = n_choices, fill = group))+ +
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Type of Deck by Group",
x = "Deck Type",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
ggplot(adv_disadv_counts, aes(x = deck_type, y = n_choices, fill = group))+
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Type of Deck by Group",
x = "Deck Type",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
ggplot(deck_counts, aes(x = deck, y = percent, fill = group)) +
geom_col(position = "dodge") +
labs(
title = "Percent of Choices per Deck by Group",
x = "Deck",
y = "Percent of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# percentage of choices per deck by group
deck_counts <- all_data %>%
group_by(group, deck) %>%
summarise(n_choices = n(), .groups = "drop") %>%
group_by(group) %>%
mutate(percent = n_choices / sum(n_choices) * 100)
ggplot(deck_counts, aes(x = deck, y = percent, fill = group)) +
geom_col(position = "dodge") +
labs(
title = "Percent of Choices per Deck by Group",
x = "Deck",
y = "Percent of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# plot how often each deck is chosen per group
deck_counts <- all_data %>%
group_by(group, deck) %>%
summarise(n_choices = n(), .groups = "drop")
ggplot(deck_counts, aes(x = deck, y = n_choices, fill = group)) +
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Deck by Group",
x = "Deck",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# percentage of choices per deck by group
deck_counts <- all_data %>%
group_by(group, deck) %>%
summarise(n_choices = n(), .groups = "drop") %>%
group_by(group) %>%
mutate(percent = n_choices / sum(n_choices) * 100)
ggplot(deck_counts, aes(x = deck, y = percent, fill = group)) +
geom_col(position = "dodge") +
labs(
title = "Percent of Choices per Deck by Group",
x = "Deck",
y = "Percent of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Plot how advantageous and disadvantageous decks are chosen per group
adv_disadv_counts <- all_data %>%
group_by(group, deck_type) %>%
summarise(n_choices = n(), .groups = "drop") %>%
group_by(group) %>%
mutate(percent = n_choices / sum(n_choices) * 100)
ggplot(adv_disadv_counts, aes(x = deck_type, y = percent, fill = group))+
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Type of Deck by Group",
x = "Deck Type",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
ggplot(adv_disadv_counts, aes(x = deck_type, y = percent, fill = group))+
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Type of Deck by Group",
x = "Deck Type",
y = "Number of Choices"
) +
scale_fill_brewer(palette = "Set1")
theme_minimal() +
ggplot(adv_disadv_counts, aes(x = deck_type, y = percent, fill = group))+
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Type of Deck by Group",
x = "Deck Type",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
# Plot how advantageous and disadvantageous decks are chosen per group
adv_disadv_counts <- all_data %>%
group_by(group, deck_type) %>%
summarise(n_choices = n(), .groups = "drop") %>%
group_by(group) %>%
mutate(percent = n_choices / sum(n_choices) * 100)
ggplot(adv_disadv_counts, aes(x = deck_type, y = percent, fill = group))+
geom_col(position = "dodge") +
labs(
title = "Number of Choices per Type of Deck by Group",
x = "Deck Type",
y = "Number of Choices"
) +
theme_minimal() +
scale_fill_brewer(palette = "Set1")
